# Qwen2VL Environment Configuration Template

# Copy this file to .env and configure as needed
# Location: qwen2vl2b/.env

# ============================================================================
# Server Configuration
# ============================================================================

# Flask Server Port (default: 5000)
FLASK_PORT=5000

# Flask Environment (development or production)
FLASK_ENV=development

# Enable Flask Debug Mode (True/False)
FLASK_DEBUG=False

# ============================================================================
# Model Configuration
# ============================================================================

# Model Directory (relative to server.py location)
MODEL_DIR=./qwen2vl2b

# Max image size for processing (e.g., 512x512, 1024x1024)
MAX_PIXELS=1024

# Model Device (auto, cuda, cpu, mps)
# - auto: Automatically detect best device
# - cuda: Force NVIDIA GPU
# - cpu: Force CPU only
# - mps: Force Apple Metal (for M1/M2/M3)
MODEL_DEVICE=auto

# Data Type for Model (float32, float16)
# - float32: More memory, higher precision (CPU default)
# - float16: Less memory, faster (GPU default)
MODEL_DTYPE=float16

# Enable 4-bit Quantization (True/False) - requires bitsandbytes
# Reduces memory usage by ~75% with minimal quality loss
ENABLE_QUANTIZATION=True

# ============================================================================
# Image Processing
# ============================================================================

# Image Upload Directory
IMAGES_DIR=./images

# Max image file size in MB (for uploads)
MAX_FILE_SIZE=10

# Allowed image formats (comma-separated)
ALLOWED_FORMATS=jpg,jpeg,png,gif,webp,bmp

# ============================================================================
# Performance & Optimization
# ============================================================================

# Number of worker threads for Flask
WORKERS=4

# Enable caching of generated captions (True/False)
ENABLE_CACHE=True

# Cache expiry time in seconds (3600 = 1 hour)
CACHE_EXPIRY=3600

# Batch size for processing multiple images
BATCH_SIZE=1

# ============================================================================
# Logging & Debugging
# ============================================================================

# Logging Level (DEBUG, INFO, WARNING, ERROR, CRITICAL)
LOG_LEVEL=INFO

# Log to file (True/False)
LOG_TO_FILE=False

# Log file path
LOG_FILE=./qwen_server.log

# Enable verbose output (True/False)
VERBOSE=False

# ============================================================================
# CORS Configuration
# ============================================================================

# Allow frontend origin (for development)
CORS_ALLOW_ORIGIN=http://localhost:8080

# Allowed HTTP methods
CORS_ALLOW_METHODS=GET,POST,PUT,DELETE,OPTIONS

# Allowed headers
CORS_ALLOW_HEADERS=Content-Type,Authorization

# ============================================================================
# Hardware Detection
# ============================================================================

# GPU Memory Fraction (for NVIDIA CUDA)
# Values: 0.0 to 1.0 (default: 1.0 = use all available)
GPU_MEMORY_FRACTION=1.0

# Disable GPU (True/False) - Force CPU even if GPU available
DISABLE_GPU=False

# ============================================================================
# System Paths (usually auto-detected, change if needed)
# ============================================================================

# Python Virtual Environment Path
VENV_PATH=./.venv

# Path to model tokenizer
TOKENIZER_PATH=./qwen2vl2b/tokenizer.json

# ============================================================================
# Development & Testing
# ============================================================================

# Enable Test Mode (True/False)
# When True, uses test images instead of real uploads
TEST_MODE=False

# Test Image Directory (used when TEST_MODE=True)
TEST_IMAGE_DIR=./test_images

# Enable Profiling (True/False) - Measures performance
ENABLE_PROFILING=False

# ============================================================================
# API Configuration
# ============================================================================

# API Request Timeout (seconds)
API_TIMEOUT=300

# Max concurrent requests
MAX_CONCURRENT_REQUESTS=5

# Rate limiting - requests per minute (0 = unlimited)
RATE_LIMIT_REQUESTS_PER_MINUTE=0

# ============================================================================
# Notes for Setup
# ============================================================================

# 1. FOR NVIDIA GPU (Fastest):
#    MODEL_DEVICE=cuda
#    MODEL_DTYPE=float16
#    ENABLE_QUANTIZATION=True

# 2. FOR APPLE SILICON (Fast):
#    MODEL_DEVICE=mps
#    MODEL_DTYPE=float16
#    ENABLE_QUANTIZATION=False

# 3. FOR CPU ONLY (Slower):
#    MODEL_DEVICE=cpu
#    MODEL_DTYPE=float32
#    ENABLE_QUANTIZATION=False

# 4. FOR LIMITED MEMORY:
#    ENABLE_QUANTIZATION=True
#    MAX_PIXELS=512
#    BATCH_SIZE=1

# 5. FOR PRODUCTION:
#    FLASK_ENV=production
#    FLASK_DEBUG=False
#    LOG_LEVEL=WARNING
#    CORS_ALLOW_ORIGIN=your-domain.com
